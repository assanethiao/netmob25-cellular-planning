# @package _global_
# VAE-LSTM with distance-aware loss for better real-world metric optimization
# Usage: python scripts/train.py +experiment=vae_lstm_distance_aware training=adaptive_training devices=[6] accelerator=gpu
defaults:
  - _self_

# Model configuration (should match the pretrained model architecture)
model:
  hidden_dim: 128
  latent_dim: 16
  num_layers: 2
  condition_dim: 32
  dropout: 0.1

# Training configuration with distance-aware loss
training:
  # Path to pretrained checkpoint
  pretrained_checkpoint: experiments/vae_lstm_2025-09-02_09-27-49/checkpoints/last.ckpt
  
  # Basic training parameters
  batch_size: 256
  epochs: 20000
  learning_rate: 0.0001
  val_split: 0.1
  gradient_clip: 1.0
  
  # Early stopping and LR scheduling
  early_stopping_enabled: false
  lr_scheduler_enabled: false
  best_metric_monitor: val_loss
  
  # Distance-aware loss configuration
  loss:
    type: distance_vae
    params:
      beta:
        type: adaptive_slow_annealing
        params:
          initial_beta: 0.000001
          target_beta: 0.3
          beta_increment: 0.005  # Slightly faster than base config
          patience_epochs: 40  # Balance between speed and stability
          improvement_threshold: 1e-5
      distance_loss_config:
        coordinate_weight: 0.00  # Remove coordinate MSE - not useful for trajectories
        point_distance_weight: 0.15  # Real point-to-point distance errors
        consecutive_distance_weight: 0.05  # Ensures smooth spacing between points
        cumulative_distance_weight: 0.8  # Total trajectory accuracy
      free_bits:
        enabled: false
        lambda_free_bits: 2.0

# Device configuration
accelerator: gpu
devices: [0]  # Adjust based on your system

seed: 42